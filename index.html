<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Appointment confirmation of Italy embassy in Tehran</title>
    <style>
        /* Base Styles and Layout (Formal Design) */
        body {
            font-family: 'Times New Roman', Times, serif; 
            margin: 0;
            padding: 0;
            background-color: #f0f0f0; 
            color: #1a1a1a;
        }

        /* Loading Screen (5 seconds delay) */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.98);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Custom CSS Spinner (Formal Rotating Animation) */
        .spinner {
            border: 8px solid #f3f3f3; 
            border-top: 8px solid #8B0000; /* Dark Red - Official Color */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 2s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Larger Header */
        header {
            background-color: #8B0000; 
            color: white;
            padding: 25px 40px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); 
            position: sticky;
            top: 0;
            z-index: 500;
        }

        header h1 {
            margin: 0;
            font-size: 1.8em; 
            font-weight: bold;
            letter-spacing: 1px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
        }

        nav ul li {
            margin-left: 30px; 
        }

        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1em;
            padding: 5px 0;
            border-bottom: 2px solid transparent;
            transition: border-bottom 0.3s, color 0.3s;
        }

        nav ul li a:hover {
            color: #ffcccb;
            border-bottom: 2px solid #ffcccb;
        }

        /* Main Container */
        .container {
            display: flex;
            min-height: calc(100vh - 200px); 
            max-width: 1300px;
            margin: 0 auto;
            padding: 20px 0;
        }

        /* Sidebar (Left side) */
        .sidebar {
            width: 220px;
            background-color: #ffffff;
            padding: 30px 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
            border-right: 5px solid #8B0000;
            border-radius: 0 5px 5px 0;
            height: fit-content;
        }

        .sidebar h3 {
            color: #8B0000;
            border-bottom: 3px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul li {
            margin-bottom: 10px;
        }

        .sidebar ul li a {
            display: block;
            padding: 10px 10px;
            color: #333;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: background-color 0.3s, border-left 0.3s;
        }

        .sidebar ul li a:hover {
            background-color: #f5f5f5;
            border-left: 3px solid #8B0000;
        }

        /* Main Content Area */
        .main-content {
            flex-grow: 1;
            padding: 0 40px;
        }

        .content-section {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .content-section h2 {
            color: #8B0000;
            border-bottom: 2px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 1em;
        }
        
        /* Buttons */
        .form-action-btn {
            background-color: #8B0000;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s;
        }

        .form-action-btn:hover:not(:disabled) {
            background-color: #a01010;
        }

        .form-action-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* Alert/Error Message */
        .message {
            margin-top: 25px;
            padding: 18px;
            border-radius: 4px;
            font-weight: bold;
            display: none;
            border-left: 5px solid;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border-left-color: #721c24;
        }

        /* Applicant Details Section */
        .applicant-details-grid {
            display: grid;
            grid-template-columns: 150px 1fr; /* Image column and Data column */
            gap: 30px;
            align-items: start;
        }

        .photo-container {
            text-align: center;
        }

        .photo-container img {
            width: 100px;
            height: 125px; /* Aspect ratio approximation for 3.5cm x 4.5cm */
            border: 3px solid #8B0000;
            object-fit: cover;
            margin-bottom: 10px;
        }

        .details-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .detail-item {
            background-color: #f9f9f9;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }

        .detail-item strong {
            display: block;
            color: #555;
            font-size: 0.85em;
        }
        
        /* Larger Footer */
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 25px 0; 
            font-size: 0.9em;
            margin-top: 20px;
            border-top: 5px solid #8B0000;
        }
        
        footer p {
            margin: 5px 0;
        }

    </style>
</head>
<body>

    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p style="color: #8B0000; font-weight: bold;">Processing Request... Please wait 5 seconds.</p>
    </div>

    <header>
        <h1>Book Appointment confirmation of Italy embassy in Tehran</h1>
        <nav>
            <ul>
                <li><a href="#" onclick="showSection('trackingSection')">Home</a></li>
                <li><a href="#">Visa Roll</a></li>
                <li><a href="#">Embassy work time</a></li>
                <li><a href="#">Know about us</a></li>
                <li><a href="#">Italy and Iran</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <aside class="sidebar">
            <h3>Quick Access</h3>
            <ul>
                <li><a href="#">Visa Application Guide</a></li>
                <li><a href="#">Required Documentation</a></li>
                <li><a href="#">Latest News & Updates</a></li>
                <li><a href="#">Contact Official Desk</a></li>
            </ul>
        </aside>

        <main class="main-content">
            
            <div id="trackingSection" class="content-section">
                <h2>Application Status Tracking</h2>
                <form id="trackingForm">
                    <div class="form-group">
                        <label for="name">1. Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">2. Last Name</label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="nationality">3. Nationality</label>
                        <input type="text" id="nationality" name="nationality" required>
                    </div>
                    <div class="form-group">
                        <label for="nationalId">4. National ID No</label>
                        <input type="text" id="nationalId" name="nationalId" required>
                    </div>
                    <div class="form-group">
                        <label for="ceuNumber">5. CEU Number</label>
                        <input type="text" id="ceuNumber" name="ceuNumber" required>
                    </div>
                    <button type="submit" id="trackBtn" class="form-action-btn" disabled>Track Now</button>
                    <div id="trackMessage" class="message error"></div>
                </form>
            </div>

            <div id="detailsSection" class="content-section" style="display: none;">
                <h2>Applicant & Appointment Details</h2>
                
                <div id="applicantInfo" class="applicant-details-grid">
                    </div>
                
                <button id="proceedPaymentBtn" class="form-action-btn" style="background-color: #008000; margin-top: 30px;">Proceed to Payment</button>
            </div>
            
            <div id="paymentSection" class="content-section" style="display: none;">
                <h2>Payment Portal Simulation</h2>
                
                <div id="paymentResult" class="message" style="display: block;">
                    <p>Current Payment Due: <strong id="paymentAmountDisplay"></strong></p>
                </div>
                
                <p>Note: This is a simulation. Clicking 'Pay Now' will process for 5 seconds.</p>
                
                <button id="payNowBtn" class="form-action-btn" style="background-color: #008000;">Pay Now</button>
                <div id="finalPaymentMessage" class="message success"></div>
                
                <button id="returnHomeBtn" class="form-action-btn" style="background-color: #555; display: none; margin-top: 15px;" onclick="showSection('trackingSection')">Return to Home</button>
            </div>
            
        </main>
    </div>

    <footer>
        <p><strong>Embassy of Italy in Tehran Official Portal</strong></p>
        <p>&copy; 2025. All Rights Reserved. | Address: Tehran, Farmanieh, Lavasani St. | Contact: info@italyembassy.ir</p>
        <p>Official Government Website Simulation.</p>
    </footer>

    <script>
        // 1. Data Structure (Shallow simulation of data.json)
        const applicantData = [
            {
                // Note: Farsi names are used for the matching logic as specified.
                Name: "فرهاد", 
                LastName: "احسان",
                FatherName: "رمضان",
                Nationality: "افغان",
                NationalID: "101010",
                PassportNumber: "202020",
                PassportIssueDate: "01/01/2000",
                PassportExpiryDate: "01/01/2030",
                MaritalStatus: "Married",
                SpouseName: "ندا", 
                SpouseLastName: "اکبری",
                SpouseFatherName: "یوسف",
                SpouseNationality: "افغان",
                SpouseNationalID: "303030",
                SpousePassportNumber: "404040",
                SpousePassportIssueDate: "01/01/2000",
                SpousePassportExpiryDate: "01/01/2030",
                CEUNumber: "CEU-5678",
                TypeOfDoc: "Humanitarian/Resettlement",
                ApprovalDate: "20/08/2025",
                ChildrenCount: "2",
                SonsCount: "1",
                DaughtersCount: "1",
                PhotoLink: "https://via.placeholder.com/100x125?text=Photo+3.5x4.5cm", // Placeholder Image Link
                PaymentAmount: "230 EUR"
            }
        ];
        
        let currentApplicant = null;

        // Utility: Loading Handler
        const loadingOverlay = document.getElementById('loadingOverlay');
        const TRACKING_DURATION = 5000; // 5 seconds

        function showLoading() {
            loadingOverlay.classList.remove('hidden');
        }

        async function hideLoading() {
            return new Promise(resolve => {
                setTimeout(() => {
                    loadingOverlay.classList.add('hidden');
                    resolve();
                }, TRACKING_DURATION);
            });
        }
        
        function showSection(sectionId) {
            document.getElementById('trackingSection').style.display = 'none';
            document.getElementById('detailsSection').style.display = 'none';
            document.getElementById('paymentSection').style.display = 'none';
            
            const target = document.getElementById(sectionId);
            if (target) {
                target.style.display = 'block';
            }
        }

        // --- Initial Load ---
        window.addEventListener('load', () => {
            showLoading();
            hideLoading().then(() => {
                showSection('trackingSection');
            });
        });

        // --- 4. Tracking Logic ---

        const trackingForm = document.getElementById('trackingForm');
        const trackInputs = trackingForm.querySelectorAll('input');
        const trackBtn = document.getElementById('trackBtn');
        const trackMessage = document.getElementById('trackMessage');

        // Input Validation: Enable/Disable Track Button
        trackInputs.forEach(input => {
            input.addEventListener('input', () => {
                const allFilled = Array.from(trackInputs).every(i => i.value.trim() !== '');
                trackBtn.disabled = !allFilled;
                trackMessage.style.display = 'none'; 
            });
        });

        // Track Now Handler
        trackingForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            showLoading();

            const inputData = {
                Name: document.getElementById('name').value.trim(),
                LastName: document.getElementById('lastName').value.trim(),
                Nationality: document.getElementById('nationality').value.trim(),
                NationalID: document.getElementById('nationalId').value.trim(),
                CEUNumber: document.getElementById('ceuNumber').value.trim(),
            };

            await hideLoading();

            // Match based on required 5 fields
            const foundApplicant = applicantData.find(applicant =>
                applicant.Name === inputData.Name &&
                applicant.LastName === inputData.LastName &&
                applicant.Nationality === inputData.Nationality &&
                applicant.NationalID === inputData.NationalID &&
                applicant.CEUNumber === inputData.CEUNumber
            );

            if (foundApplicant) {
                currentApplicant = foundApplicant;
                trackMessage.style.display = 'none';
                displayAppointmentDetails(foundApplicant);
                showSection('detailsSection');
            } else {
                trackMessage.classList.remove('success');
                trackMessage.classList.add('error');
                trackMessage.textContent = 'Error: The entered information was not found in our system. Please verify and try again.';
                trackMessage.style.display = 'block';
            }
        });

        // --- 5. Appointment Details Logic ---

        function displayAppointmentDetails(applicant) {
            const applicantInfoDiv = document.getElementById('applicantInfo');
            
            const detailsList = [
                { label: 'Name', value: applicant.Name },
                { label: 'Last Name', value: applicant.LastName },
                { label: 'Father\'s Name', value: applicant.FatherName },
                { label: 'Nationality', value: applicant.Nationality },
                { label: 'National ID No', value: applicant.NationalID },
                { label: 'Passport Number', value: applicant.PassportNumber },
                { label: 'Passport Issue Date', value: applicant.PassportIssueDate },
                { label: 'Passport Expiry Date', value: applicant.PassportExpiryDate },
                { label: 'Marital Status', value: applicant.MaritalStatus },
                { label: 'Type of Document/Case', value: applicant.TypeOfDoc },
                { label: 'Case Approval Date', value: applicant.ApprovalDate },
                { label: 'Children Count', value: `${applicant.ChildrenCount} (${applicant.SonsCount} Sons, ${applicant.DaughtersCount} Daughters)` },
                { label: 'CEU Number', value: applicant.CEUNumber }
            ];

            if (applicant.MaritalStatus === 'Married') {
                detailsList.push(
                    { label: 'Spouse Name', value: `${applicant.SpouseName} ${applicant.SpouseLastName}` },
                    { label: 'Spouse Father Name', value: applicant.SpouseFatherName },
                    { label: 'Spouse National ID', value: applicant.SpouseNationalID },
                    { label: 'Spouse Passport No', value: applicant.SpousePassportNumber }
                );
            }

            const detailsHTML = detailsList.map(item => `
                <div class="detail-item">
                    <strong>${item.label}</strong>
                    <span>${item.value}</span>
                </div>
            `).join('');

            applicantInfoDiv.innerHTML = `
                <div class="photo-container">
                    <strong>Photo 3.5cm x 4.5cm</strong>
                    <img src="${applicant.PhotoLink}" alt="Applicant Photo">
                </div>
                <div class="details-list">
                    ${detailsHTML}
                </div>
            `;
            
            document.getElementById('paymentAmountDisplay').textContent = applicant.PaymentAmount;
        }

        // Proceed to Payment Button Handler
        document.getElementById('proceedPaymentBtn').addEventListener('click', async () => {
            showLoading();
            await hideLoading();
            
            // Setup payment section view
            document.getElementById('finalPaymentMessage').style.display = 'none';
            document.getElementById('payNowBtn').style.display = 'block';
            document.getElementById('payNowBtn').disabled = false;
            document.getElementById('returnHomeBtn').style.display = 'none';

            showSection('paymentSection');
        });

        // Pay Now Button Handler (Simulating payment)
        document.getElementById('payNowBtn').addEventListener('click', async () => {
            showLoading();
            document.getElementById('payNowBtn').disabled = true;
            
            await hideLoading();
            
            const finalMessage = document.getElementById('finalPaymentMessage');
            finalMessage.classList.add('success');
            finalMessage.textContent = `Payment of ${currentApplicant.PaymentAmount} processed successfully. Your appointment is confirmed.`;
            finalMessage.style.display = 'block';
            document.getElementById('returnHomeBtn').style.display = 'block';
        });

    </script>
</body>
</html>
